<mat-card>
    <mat-card-header>
        <mat-card-title>
            <div class="row">
                <div class="col-4">
                    <span matBadge="{{table.table_id}}" matBadgeOverlap="false">Tisch</span>
                </div>
                <div class="col-4 p-0" *ngIf="tableHasStartedMatch()">
                    <mat-chip-list>
                        <mat-chip class="m-0" selected color="primary">{{currentMatch().classification}}</mat-chip>
                    </mat-chip-list>
                </div>
                <div class="col-4 p-0" *ngIf="tableHasStartedMatch()">
                    <mat-chip-list>
                        <mat-chip class="m-0" selected color="primary">{{currentMatch().stage}}</mat-chip>
                    </mat-chip-list>
                </div>
            </div>
        </mat-card-title>
    </mat-card-header>
    <mat-card-content *ngIf="!tableHasStartedMatch()">
        <div class="row">
            <div class="col">
                <p>Kein Match zugewiesen</p>
            </div>
        </div>
        <app-matchlist
            [matches]="table.matches"
        ></app-matchlist>
    </mat-card-content>
    <mat-card-content *ngIf="tableHasStartedMatch()">
        <div class="row">
            <div class="col-5">
            </div>
            <div class="col-1 mat-small" *ngFor="let game of maxGames">
                <p>{{game + 1}}</p>
            </div>
            <div class="col-1 mat-small">
                <p>Tot</p>
            </div>
        </div>
        <div class="row">
            <a  mat-button class="col-5" (click)="openGameDialog(currentMatch().player_a, true)" >
                <p [ngClass]="{'match-won': this.gameService.playerWonMatch(currentMatch().result.games_won_player_a)}" class="mat-body-strong mb-0">{{currentMatch().players_a | playerName}}</p>
              <p>{{currentMatch().players_a | clubName}}</p>
            </a>
            <div class="col-1" *ngFor="let game of allGames()">
                <p [ngClass]="{'won': this.gameService.playerAWon(game)}" class="mat-body">{{game.score_player_a}}</p>
            </div>
            <div class="col-1">
                <p [ngClass]="{'match-won': this.gameService.playerWonMatch(currentMatch().result.games_won_player_a)}" class="mat-body">{{currentMatch().result.games_won_player_a}}</p>
            </div>
        </div>
        <div class="row">
            <a mat-button class="col-5" (click)="openGameDialog(currentMatch().player_b, false)">
                <p [ngClass]="{'match-won': this.gameService.playerWonMatch(currentMatch().result.games_won_player_b)}" class="mat-body-strong mb-0">{{currentMatch().players_b | playerName}}</p>
              <p>{{currentMatch().players_b | clubName}}</p>
            </a>
            <div class="col-1" *ngFor="let game of allGames()">
                <p [ngClass]="{'won': this.gameService.playerBWon(game)}" class="mat-body">{{game.score_player_b}}</p>
            </div>
            <div class="col-1">
                <p [ngClass]="{'match-won': this.gameService.playerWonMatch(currentMatch().result.games_won_player_b)}" class="mat-body">{{currentMatch().result.games_won_player_b}}</p>
            </div>
        </div>
    </mat-card-content>
    <mat-card-actions>
      <button *ngIf="tableHasNoStartedAndAtLeastOneMatch()" mat-raised-button color="warn" (click)="startMatch()">Starten</button>
      <button *ngIf="tableHasNoStartedAndAtLeastOneMatch()" mat-raised-button color="accent" (click)="callPlayer()">Melden</button>
      <button *ngIf="tableHasStartedMatch()" mat-raised-button color="primary" (click)="openResultDialog()">Erfassen</button>
      <button *ngIf="tableHasStartedMatch()" mat-raised-button color="accent" (click)="endMatch()">Beenden</button>
    </mat-card-actions>
</mat-card>
